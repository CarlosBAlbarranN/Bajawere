<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML, CSS Y JAVASCRIPT</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <h4>Simulados de Amortizaciones</h4>
        <hr>
        <table class="table" id="mytable">
            <colgroup>
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
                <col width="8%">
            </colgroup>
            <thead>
                <tr>
                    <th class="text-center">Numero</th>
                    <th class="text-center">Fecha Inicio</th>
                    <th class="text-center">Fecha Vencimiento</th>
                    <th class="text-center">Fecha Pago</th>
                    <th class="text-center">Capital</th>
                    <th class="text-center">Interes</th>
                    <th class="text-center">IVA Interes</th>
                    <th class="text-center">Total Pago</th>
                    <th class="text-center">Saldo Capital</th>
                    <th class="text-center"></th>
                    <th class="text-center"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input class="form-text-input row-item" type="number" value="1"></input></td>
                    <td><input class="form-text-input row-item" type="date"  value="2023-07-22"></input></td>
                    <td><input class="form-text-input row-item" type="date"  value="2023-07-22"></input></td>
                    <td><input class="form-text-input row-item" type="date"  value="2023-07-22"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" value="0"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="0"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="12"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="12"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="12"></input></td>
                    <td class="">
                        <div class="form-check ">
                            <input class='form-check-input row-item' hidden type='checkbox'  >
                            <img src="minus_PNG17.png" height="15" width="15" />
                        </div>
                    </td>
                    <td class="">
                            <img src="plus-24844_640.png" height="15" width="15" />
                    </td>
                </tr>
                <tr>
                    <td><input class='form-check-input row-item' hidden type='checkbox' checked=true></td>
                    <td></td>
                    <td></td>
                    <td>Totales:</td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>
                    <td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-primary btn-sm rounded-0" hidden id="add_row" type="button">Agregar Fila</button>
        <button class="btn btn-danger btn-sm rounded-0" hidden id="delete_selected" type="button">Eliminar Fila Seleccionada</button>
    </div>
</body>

<script>
var contador=1;
var capital=0;

    $(document).ready(function() {
        
        $(document).on('click', `[src|='minus_PNG17.png']`, function (e) {
            event.preventDefault();
            $(this).closest('td').find(`input[type="checkbox"]`).click();
            if( contador<2){
                alert('Se requiere por lo menos quede una fila ');
            }
            else {
                borrar();
                agregarTotales();
            }
            
            contador--;
            return false;
        });

        $(document).on('click', `[src|='plus-24844_640.png']`, function (e) {
            agregar();
            borrar();
            agregarTotales();
           
            return false;
        });
       
        function agregar(){
            contador++;
            var rand = Math.floor((Math.random() * 10000) + 1);
            capital=capital+rand;
            var tr = $("<tr>")
            tr.append(`<td><input class="form-text-input row-item" type="number" value="${contador}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" type="date"  value="2018-07-22"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" type="date"  value="2018-07-22"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" type="date"  value="2018-07-22"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${rand}"></input></td>`)
            tr.append(`<td><div class='form-check text-center'><input class='form-check-input row-item' hidden type='checkbox'>
                            <img src="minus_PNG17.png" id='imagUno'  height="15" width="15" />
                        </div></td>`)
            tr.append(`<td><img src="plus-24844_640.png"   height="15" width="15" /></td>`)
          
            $('#mytable tbody').append(tr)

            $('tr').find('.row-item').change(function() {
                if ($(".row-item").length == $(".row-item:checked").length) {
                    $('#SelectAll').prop('checked', true)
                } else {
                    $('#SelectAll').prop('checked', false)
                }
            })
        }

        function agregarTotales(){
            var rand = Math.floor((Math.random() * 10) + 1);
            var tr = $("<tr>")
            tr.append(`<td><input class='form-check-input row-item' hidden type='checkbox' checked=true></td>`)
            tr.append(`<td></td>`)
            tr.append(`<td></td>`)
            tr.append(`<td>Totales:</td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${capital}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${capital}"></input></td>`)
            tr.append(`<td><input class="form-text-input row-item" style="text-align: right" type="number" value="${capital}"></input></td>`)
            tr.append(`<td></td>`)
            tr.append(`<td></td>`)
            tr.append(`<td></td>`)
            tr.append(`<td></td>`)
            $('#mytable tbody').append(tr)
        }
        
        function borrar(){
            var count = $('.row-item:checked').length
            if (count <= 0) {
                alert("Please select atleast 1 table row to remove first.")
            } else {
                $('.row-item:checked').closest('tr').remove()
            }
        }
        
        $('.row-item').change(function() {
            if ($(".row-item").length == $(".row-item:checked").length) {
                $('#SelectAll').prop('checked', true)
            } else {
                $('#SelectAll').prop('checked', false)
            }
        })
    })
</script>

</html>